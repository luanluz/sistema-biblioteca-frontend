<div class="bg-white border border-gray-200 rounded-lg">
    <div class="pt-4 px-4">
        <p-toolbar class="mb-6">
            <ng-template #start>
                <h5 class="m-0">Gerenciar Livros</h5>
            </ng-template>
            <ng-template #end>
                <p-button label="Novo" icon="pi pi-plus" class="mr-2" (onClick)="openNew()"/>
            </ng-template>
        </p-toolbar>
    </div>

    <div class="bg-white border border-gray-200 rounded-lg mx-4 mb-4">
        <p-table
            [value]="livros"
            [rows]="rows"
            [paginator]="true"
            [rowsPerPageOptions]="[10, 20, 50, 100]"
            [totalRecords]="totalRecords"
            [tableStyle]="{ 'min-width': '75rem' }"
            [rowHover]="true"
            dataKey="codigo"
            currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} livros"
            [showCurrentPageReport]="true"
            [loading]="loading"
            (onPage)="onPageChange($event)"
            [lazy]="true"
        >
            <ng-template #header>
                <tr>
                    <th>Código</th>
                    <th>Título</th>
                    <th>Editora</th>
                    <th>Edição</th>
                    <th>Ano</th>
                    <th>Valor</th>
                    <th>Ações</th>
                </tr>
            </ng-template>
            <ng-template #body let-livro>
                <tr>
                    <td>{{ livro.codigo }}</td>
                    <td>{{ livro.titulo }}</td>
                    <td>{{ livro.editora }}</td>
                    <td>{{ livro.edicao }}</td>
                    <td>{{ livro.anoPublicacao }}</td>
                    <td>{{ livro.valorEmCentavos / 100 | currency: 'BRL' }}</td>
                    <td>
                        <p-buttongroup>
                            <p-button
                                icon="pi pi-pencil"
                                (click)="editLivro(livro)"
                                severity="secondary"
                            />
                            <p-button
                                icon="pi pi-eye"
                                (click)="viewLivro(livro)"
                                severity="secondary"
                            />
                            <p-button
                                icon="pi pi-trash"
                                severity="contrast"
                                (click)="deleteLivro(livro)"
                            />
                        </p-buttongroup>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>

    <app-livro-form
        [(visible)]="formDrawerVisible"
        [livroCodigo]="selectedLivroCodigo"
        (eventEmitterSave)="onSaveSuccess()"
    />

    <app-livro-view
        [(visible)]="viewDrawerVisible"
        [livroCodigo]="viewLivroCodigo"
    />

    <p-confirmDialog [style]="{ width: '450px', maxWidth: '100vw' }"/>
</div>
